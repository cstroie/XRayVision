<!DOCTYPE html>
<html data-theme="dark" lang="en">
<!--
  XRayVision - Async DICOM processor with OpenAI and WebSocket dashboard.
  Copyright (C) 2025 Costin Stroie <costinstroie@eridu.eu.org>

  This program is free software: you can redistribute it and/or modify
  it under the terms of the GNU General Public License as published by
  the Free Software Foundation, either version 3 of the License, or
  any later version.
-->
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="color-scheme" content="light dark">
    <title>XRayVision About</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@picocss/pico@2/css/pico.colors.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@picocss/pico@2/css/pico.slate.min.css">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon-64x64.png" type="image/png" sizes="64x64">
    <style>
        :root {
            --pico-font-family-sans-serif: Inter, system-ui, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, Helvetica, Arial, "Helvetica Neue", sans-serif, var(--pico-font-family-emoji);
            --pico-font-size: 87.5%;
            --pico-line-height: 1.6;
            --pico-border-radius: 0.5rem;
            --card-border-radius: 0.75rem;
            --card-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            --card-shadow-hover: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }

        @media (min-width: 576px) {
            :root {
                --pico-font-size: 100%;
            }
        }

        @media (min-width: 768px) {
            :root {
                --pico-font-size: 106.25%;
            }
        }

        @media (min-width: 1024px) {
            :root {
                --pico-font-size: 112.5%;
            }
        }

        @media (min-width: 1280px) {
            :root {
                --pico-font-size: 118.75%;
            }
        }

        @media (min-width: 1536px) {
            :root {
                --pico-font-size: 125%;
            }
        }

        h1, h2, h3, h4, h5, h6 {
            --pico-font-weight: 600;
        }

        article {
            border: 1px solid var(--pico-muted-border-color);
            border-radius: var(--card-border-radius);
            box-shadow: var(--card-shadow);
            transition: box-shadow 0.2s ease;
        }

        article:hover {
            box-shadow: var(--card-shadow-hover);
        }

        article>footer {
            border-radius: var(--card-border-radius);
        }

        main {
            background-color: var(--pico-background-color);
            padding: 2rem;
            border-radius: var(--card-border-radius);
            box-shadow: var(--card-shadow);
            margin-bottom: 1.5rem;
        }

        main h2 {
            margin-top: 2rem;
            padding-bottom: 0.5rem;
            border-bottom: 1px solid var(--pico-muted-border-color);
        }

        main h2:first-child {
            margin-top: 0;
        }

        ul {
            background-color: rgba(30, 30, 40, 0.3);
            padding: 1.5rem;
            border-radius: var(--pico-border-radius);
        }

        footer {
            text-align: center;
            padding: 1.5rem;
            background-color: var(--pico-background-color);
            border-radius: var(--card-border-radius);
            box-shadow: var(--card-shadow);
        }
    </style>
</head>
<body class="container">
    <nav>
        <ul>
            <li><strong>XRayVision About</strong></li>
        </ul>
        <ul>
            <li><a href="/">Dashboard</a></li>
            <li><a href="/stats">Statistics</a></li>
            <li><a href="/about" class="contrast">About</a></li>
        </ul>
    </nav>
    <main>
        <h2>Overview</h2>
        <p><strong>XRayVision</strong> is an open-source medical imaging platform designed for real-time DICOM ingestion, processing, and interactive review of radiology studies with AI-powered assistance.</p>
        
        <h2>Key Features</h2>
        <ul>
            <li><strong>AI-Powered Analysis</strong> - Integrates with OpenAI (primary &amp; fallback) for intelligent image interpretation</li>
            <li><strong>DICOM Compatibility</strong> - Supports storescp-based DICOM reception for seamless integration with medical imaging systems</li>
            <li><strong>Real-Time Dashboard</strong> - WebSocket-powered interface with live queue monitoring and instant result updates</li>
            <li><strong>Database Management</strong> - SQLite-based exam storage with advanced pagination, filtering, and flagging capabilities</li>
            <li><strong>Comprehensive Analytics</strong> - Detailed statistics with anatomical breakdown and system health monitoring</li>
            <li><strong>Query/Retrieve Integration</strong> - Automatic polling and manual triggering of DICOM Query/Retrieve operations</li>
            <li><strong>Notification System</strong> - Ntfy.sh integration for real-time alerts on positive findings</li>
            <li><strong>Image Processing</strong> - Automatic DICOM to PNG conversion with gamma correction and resizing</li>
            <li><strong>Quality Assurance</strong> - Review and validation system for AI-generated reports with accuracy metrics</li>
            <li><strong>Modern Architecture</strong> - Fully asynchronous and responsive design built with aiohttp and PicoCSS</li>
        </ul>
        
        <h2>How It Works</h2>
        <p>XRayVision is a comprehensive medical imaging platform that automates the processing and analysis of radiology studies. The system follows a streamlined workflow to deliver efficient and accurate results:</p>
        
        <h3>Data Ingestion</h3>
        <p>XRayVision receives DICOM studies through two primary methods:</p>
        <ul>
            <li><strong>DICOM StoreSCP</strong> - Continuous reception of studies sent from PACS, modalities, or other DICOM sources</li>
            <li><strong>Query/Retrieve</strong> - Automatic polling (every 15 minutes) or manual triggering to fetch recent studies from remote DICOM servers</li>
        </ul>
        
        <h3>Image Processing</h3>
        <p>Upon receipt, each DICOM study undergoes several processing steps:</p>
        <ul>
            <li><strong>Format Conversion</strong> - DICOM files are automatically converted to optimized PNG format for web display</li>
            <li><strong>Image Enhancement</strong> - Automatic gamma correction and contrast optimization for improved visualization</li>
            <li><strong>Metadata Extraction</strong> - Patient demographics, study details, and protocol information are parsed and stored</li>
        </ul>
        
        <h3>AI Analysis</h3>
        <p>The core intelligence of XRayVision lies in its AI-powered analysis engine:</p>
        <ul>
            <li><strong>Region Identification</strong> - Automatic anatomical region detection based on protocol names and imaging parameters</li>
            <li><strong>Intelligent Prompting</strong> - Context-aware prompts are generated for each study type, focusing the AI on relevant pathologies</li>
            <li><strong>Dual Backend Support</strong> - Integration with primary and fallback OpenAI-compatible APIs for maximum reliability</li>
            <li><strong>Structured Reporting</strong> - AI responses are parsed into standardized JSON format with short answers and detailed reports</li>
        </ul>
        
        <h3>Results Presentation &amp; Review</h3>
        <p>Processed studies are presented through an intuitive web dashboard:</p>
        <ul>
            <li><strong>Real-time Updates</strong> - WebSocket-powered interface provides instant notifications when new studies are processed</li>
            <li><strong>Interactive Review</strong> - Medical professionals can validate AI findings as accurate or flag them for review</li>
            <li><strong>Quality Assurance</strong> - Discrepancies between AI predictions and human review are tracked for continuous improvement</li>
            <li><strong>Notification System</strong> - Critical positive findings trigger immediate alerts via ntfy.sh integration</li>
        </ul>
        
        <h3>Data Management</h3>
        <p>XRayVision maintains comprehensive data management capabilities:</p>
        <ul>
            <li><strong>SQLite Database</strong> - All studies, reports, and review statuses are stored in a robust local database</li>
            <li><strong>Advanced Filtering</strong> - Studies can be filtered by region, status, review state, and search terms</li>
            <li><strong>Statistical Analytics</strong> - Detailed performance metrics and trend analysis are available through the statistics dashboard</li>
            <li><strong>Automatic Cleanup</strong> - Ignored and erroneous studies are automatically purged after one week to maintain system performance</li>
        </ul>
        
        <h2>Global Parameters</h2>
        <article>
            <table role="grid">
                <tbody>
                    <tr>
                        <td><strong>OpenAI Primary URL</strong></td>
                        <td><code id="openai-primary">Loading...</code></td>
                    </tr>
                    <tr>
                        <td><strong>OpenAI Secondary URL</strong></td>
                        <td><code id="openai-secondary">Loading...</code></td>
                    </tr>
                    <tr>
                        <td><strong>NTFY URL</strong></td>
                        <td><code id="ntfy-url">Loading...</code></td>
                    </tr>
                    <tr>
                        <td><strong>AE Title</strong></td>
                        <td><code id="ae-title">Loading...</code></td>
                    </tr>
                    <tr>
                        <td><strong>AE Port</strong></td>
                        <td><code id="ae-port">Loading...</code></td>
                    </tr>
                    <tr>
                        <td><strong>Remote AE Title</strong></td>
                        <td><code id="remote-ae-title">Loading...</code></td>
                    </tr>
                    <tr>
                        <td><strong>Remote AE IP</strong></td>
                        <td><code id="remote-ae-ip">Loading...</code></td>
                    </tr>
                    <tr>
                        <td><strong>Remote AE Port</strong></td>
                        <td><code id="remote-ae-port">Loading...</code></td>
                    </tr>
                </tbody>
            </table>
        </article>
    </main>
    <footer>
        <small>Project licensed under <a href="https://www.gnu.org/licenses/gpl-3.0.html">GPLv3</a>. Created by Costin Stroie, 2025.</small>
    </footer>
    
    <script>
        // Fetch global parameters from the server
        fetch('/api/config')
            .then(response => response.json())
            .then(data => {
                document.getElementById('openai-primary').textContent = data.OPENAI_URL_PRIMARY || 'Not set';
                document.getElementById('openai-secondary').textContent = data.OPENAI_URL_SECONDARY || 'Not set';
                document.getElementById('ntfy-url').textContent = data.NTFY_URL || 'Not set';
                document.getElementById('ae-title').textContent = data.AE_TITLE || 'Not set';
                document.getElementById('ae-port').textContent = data.AE_PORT || 'Not set';
                document.getElementById('remote-ae-title').textContent = data.REMOTE_AE_TITLE || 'Not set';
                document.getElementById('remote-ae-ip').textContent = data.REMOTE_AE_IP || 'Not set';
                document.getElementById('remote-ae-port').textContent = data.REMOTE_AE_PORT || 'Not set';
            })
            .catch(error => {
                console.error('Error fetching config:', error);
                const loadingElements = document.querySelectorAll('code[id^="openai-"], code[id^="ntfy-"], code[id^="ae-"], code[id^="remote-ae-"]');
                loadingElements.forEach(el => el.textContent = 'Error loading');
            });
    </script>
</body>
</html>
